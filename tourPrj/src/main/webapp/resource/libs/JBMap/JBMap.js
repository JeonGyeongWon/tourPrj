proj4.defs("EPSG:5179","+proj\x3dtmerc +lat_0\x3d38 +lon_0\x3d127.5 +k\x3d0.9996 +x_0\x3d1000000 +y_0\x3d2000000 +ellps\x3dGRS80 +towgs84\x3d0,0,0,0,0,0,0 +units\x3dm +no_defs");proj4.defs("UTMK","+proj\x3dtmerc +lat_0\x3d38.0 +lon_0\x3d127.5 +x_0\x3d1000000.0 +y_0\x3d2000000.0 +k\x3d0.9996 +a\x3d6378137.0 +b\x3d6356752.3141403 +ellps\x3dGRS80 +towgs84\x3d0,0,0 +no_defs");proj4.defs("KATEC","+proj\x3dtmerc +lat_0\x3d38 +lon_0\x3d128 +k\x3d0.9999 +x_0\x3d400000 +y_0\x3d600000 +ellps\x3dbessel +towgs84\x3d-145.907,505.034,685.756,-1.162,2.347,1.592,6.342 +units\x3dm +no_defs");
proj4.defs("EPSG:5175","+proj\x3dtmerc +lat_0\x3d38 +lon_0\x3d127.00289 +k\x3d1 +x_0\x3d200000 +y_0\x3d550000 +ellps\x3dbessel +towgs84\x3d-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43 +units\x3dm +no_defs");proj4.defs("EPSG:5174","+proj\x3dtmerc +lat_0\x3d38 +lon_0\x3d127.00289 +k\x3d1 +x_0\x3d200000 +y_0\x3d500000 +ellps\x3dbessel +towgs84\x3d-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43 +units\x3dm +no_defs");proj4.defs("EPSG:5181","+proj\x3dtmerc +lat_0\x3d38 +lon_0\x3d127 +k\x3d1 +x_0\x3d200000 +y_0\x3d500000 +ellps\x3dGRS80 +towgs84\x3d0,0,0,0,0,0,0 +units\x3dm +no_defs");
var JBMap=function(k){function ha(a){if(ia)for(var b=a.getCoordinates(),c=a=0,e=b.length-1;c<e;++c){var d=ol.proj.transform(b[c],p,r),f=ol.proj.transform(b[c+1],p,r);a+=N.haversineDistance(d,f)}else a=Math.round(100*a.getLength())/100;return 100<a?Math.round(a/1E3*100)/100+" km":Math.round(100*a)/100+" m"}function ja(a){ia?(q.getProjection(),a=a.clone().transform(p,r).getLinearRing(0).getCoordinates(),a=Math.abs(N.geodesicArea(a))):a=a.getArea();return 1E4<a?Math.round(a/1E6*100)/100+" km\x3csup\x3e2\x3c/sup\x3e":
Math.round(100*a)/100+" m\x3csup\x3e2\x3c/sup\x3e"}function Ca(a){E("MEASURE");var b=h.vector.MEASURE.getSource(),c={AREA:"Polygon",LENGTH:"LineString"},e=null;c[a]&&(e=c[a]);if(e){a=new ol.interaction.Draw({source:b,type:e,style:ka});E("MEASURE",a);var d=null,f=null,g=la();a.on("drawstart",function(a){f=a.feature;var c=a.coordinate;d=f.getGeometry().on("change",function(a){a=a.target;var b;a instanceof ol.geom.Polygon?(b=ja(a),c=a.getInteriorPoint().getCoordinates()):a instanceof ol.geom.LineString&&
(b=ha(a),c=a.getLastCoordinate());g.getElement().innerHTML=b;g.setPosition(c)})},this);a.on("drawend",function(){var a=g.getElement();a.className="JBTooltip JBTooltip-static";g.setOffset([0,-7]);f=null;S.push(a);g=la();ol.Observable.unByKey(d)},this)}else{ma("MEASURE");a=0;for(b=S.length;a<b;a++)c=S[a],null!=c&&null!=c.parentNode&&(null!=c.parentNode.parentNode?c.parentNode.parentNode.removeChild(c.parentNode):c.parentNode.removeChild(c));S=[];e=m.getTargetElement().getElementsByClassName("JBTooltip JBTooltip-measure");
a=0;for(b=e.length;a<b;a++)c=e[a],null!=c&&null!=c.parentNode&&(null!=c.parentNode.parentNode?c.parentNode.parentNode.removeChild(c.parentNode):c.parentNode.removeChild(c))}}function Y(a){if(z[a]){var b=z[a].getElement();b.parentNode.parentNode.removeChild(b.parentNode);delete z[a];Z()}}function Z(a){for(var b=$.MAIN,c=b,e={},d=b,f=$.MAX;d<=f;d++){var g=na[d],l=z[g];if(l){if(a==g)continue;l.getElement().style.zIndex=++c;e[c]=g}if(c==b+Object.keys(z).length)break}a&&z[a]&&(z[a].getElement().style.zIndex=
++c,e[c]=a);$.MAX=c;na=e}function Da(a,b,c,e,d,f,g){Y(a);if(b){var l=document.createElement("div");l.onclick=function(c){c=c.target;"INPUT"==c.tagName.toUpperCase()&&"BUTTON"==c.type.toUpperCase()||Z(a)};if(d){d=document.createElement("div");d.style.position="relative";d.style.height="0px";var n=document.createElement("img");n.className="JBTooltip-closeBtn";n.src=oa;n.onclick=function(){var c=z[a];Y(a);c.close&&c.close.call(this,a)};d.appendChild(n);l.appendChild(d)}l.appendChild(b);f||(f=JBMap.CODE.TOOLTIP_POSITION.LEFT_TOP);
l.className="JBTooltip JBTooltip-content "+f;b=[6,-6];f==JBMap.CODE.TOOLTIP_POSITION.LEFT_MIDDLE?b=[6,0]:f==JBMap.CODE.TOOLTIP_POSITION.LEFT_BOTTOM?b=[6,6]:f==JBMap.CODE.TOOLTIP_POSITION.CENTER_TOP?b=[0,8]:f==JBMap.CODE.TOOLTIP_POSITION.CENTER_MIDDLE?b=[0,0]:f==JBMap.CODE.TOOLTIP_POSITION.CENTER_BOTTOM?b=[0,-8]:f==JBMap.CODE.TOOLTIP_POSITION.RIGHT_TOP?b=[-6,-6]:f==JBMap.CODE.TOOLTIP_POSITION.RIGHT_MIDDLE?b=[-6,0]:f==JBMap.CODE.TOOLTIP_POSITION.RIGHT_BOTTOM&&(b=[-6,6]);f={element:l,offset:b,positioning:f};
e&&(f.autoPan=!0,f.autoPanMargin=200,f.autoPanAnimation={duration:e});e=new ol.Overlay(f);z[a]=e;g&&(e.close=g);g=null;"string"==typeof c&&(c=F(c,r,p));g=c.length?c:"Point"==c.getType()?c.getCoordinates():c.getLastCoordinate();m.addOverlay(e);e.setPosition(g);Z(a)}}function la(){a&&(a=a.getElement(),a.parentNode.removeChild(a));a=document.createElement("div");a.className="JBTooltip JBTooltip-measure";var a=new ol.Overlay({element:a,offset:[0,-15],positioning:"bottom-center"});m.addOverlay(a);return a}
function T(a,b,c){J[a]&&(J[a][b]=c)}function U(a,b){J[a]&&delete J[a][b]}function aa(a){if(a&&h.base[a]){var b=h.base[a],c=ba(),e=q.getZoom(),d=q.getRotation();a=q.getProjection();for(var f in h.base)for(var g=h.base[f].layer,l=0,n=g.length;l<n;l++)g[l].setVisible(!1);l=0;for(n=b.layer.length;l<n;l++)b.layer[l].setVisible(!0);"undefiend"!=typeof b.minZoom&&(t.minZoom=b.minZoom);"undefiend"!=typeof b.maxZoom&&(t.maxZoom=b.maxZoom);t.zoom=e;t.rotation=d;b.projection?(H&&(H=ol.proj.transformExtent(H,
p,b.projection)),p=b.projection,t.center=ol.proj.transform(c,r,p),t.projection=p):t.center=q.getCenter();H&&(t.extent=H);b.resolutions&&(t.resolutions=b.resolutions);b.maxResolution&&(t.maxResolution=b.maxResolution);q=new ol.View(t);q.on("change:center",ca);q.on("change:resolution",da);q.on("change:rotation",pa);m.setView(q);for(var u in h.vector)for(u=h.vector[u],f=u.getSource().getFeatures(),l=0,n=f.length;l<n;l++)f[l].getGeometry().transform(a,t.projection);u=m.getOverlays().getArray();l=0;for(n=
u.length;l<n;l++)if(f=u[l],b=f.getPosition())b=ol.proj.transform(b,a,t.projection),f.setPosition(b)}}function V(){x.style.display="none"}function ca(){var a=q.getCenter(),a=ol.proj.transform(a,p,r);A("move",a)}function W(){if(C){C.stop();var a=m.getSize(),b=m.getView().calculateExtent(a),b=ol.proj.transformExtent(b,p,"EPSG:4326");w.width=a[0];w.height=a[1];C.start([[0,0],[w.width,w.height]],w.width,w.height,[[b[0],b[1]],[b[2],b[3]]])}}function K(){C&&(C.stop(),w.getContext("2d").clearRect(0,0,w.width,
w.height))}function Ea(a,b,c){null==w&&(w=document.createElement("canvas"),w.style.position="absolute",w.style.zIndex="1",w.width=m.getSize()[0],w.height=m.getSize()[1],m.getViewport().getElementsByTagName("canvas")[0].before(w));K();C=new Windy({canvas:w,data:a});W();T(JBMap.CODE.EVENT.MOVE_START,"WINDY_MOVE",function(){K()});T(JBMap.CODE.EVENT.MOVE_END,"WINDY_MOVE",function(){if(C){var a=m.getView().getZoom();a<=b&&a>=c?W():K()}});T(JBMap.CODE.EVENT.ZOOM_END,"WINDY_MOVE",function(a){C&&(a<=b&&a>=
c?W():K())})}function Fa(a){var b=a.coordinate,b=ol.proj.transform(b,p,r);A("click",a,b)}function Ga(a){if(!a.dragging){var b=m.getEventPixel(a.originalEvent);m.hasFeatureAtPixel(b)?m.forEachFeatureAtPixel(a.pixel,function(a,b){if(a){var d=a.get("features");if(d){if(0<d.length){var f=d[0],g=f.layerName;if(s[g]){if(1==d.length&&s[g].HOVER)try{var l=s[g].HOVER.call(this,f);"undefined"!=typeof l&&null!=l&&(x.innerText=l,x.style.display="")}catch(n){console.log(n)}m.getTargetElement().style.cursor="pointer";
return!1}}}else if(b&&(g=b.get("name"),v[g]))return m.getTargetElement().style.cursor="pointer",!1}}):(V(),m.getTargetElement().style.cursor="");A("mousemove",a)}}function pa(){var a=q.getRotation();A("rotate",a)}function da(){var a=q.getZoom();O.innerHTML=parseInt(a);A("zoomend",a)}function qa(){var a=q.getCenter(),a=ol.proj.transform(a,p,r);A("moveend",a)}function Ha(){var a=q.getCenter(),a=ol.proj.transform(a,p,r);A("movestart",a)}function A(a,b,c){for(var e in J[a])J[a][e].call(this,b,c)}function E(a,
b){if(a){var c=null;y[a]&&(c=b?b:y[a],m.removeInteraction(c),delete y[a]);b&&(y[a]=b,m.addInteraction(b))}}function F(a,b,c){try{var e=null;if("string"==typeof a)e=D.readFeature(a).getGeometry();else if("object"==typeof a)e=a;else return null;return e.transform(b,c)}catch(d){return console.log(d),null}}function ra(a,b){var c=ol.proj.transform([a,b],r,p);q.setCenter(c)}function sa(a){if(h.vector[a]){for(var b=y.featureClick.getFeatures(),c=b.getArray(),e=[],d=0,f=c.length;d<f;d++){var g=c[d];g.layerName==
a&&e.push(g)}d=0;for(f=e.length;d<f;d++)b.remove(e[d]);m.removeLayer(h.vector[a]);delete h.vector[a];v[a]&&delete v[a];for(d=0;d<L.length;d++)b=L[d],null!=b&&b.get("name")==a&&(L.splice(d,1),d--);V()}}function Ia(a,b,c,e,d,f,g,l,n,u){b||(b=40);"function"!=typeof e&&(e=function(a,c){var b=0,d=0;25<a?(b=192,d=0):(b=8<a?255:0,d=128);var b=b+","+d+",0",d=Math.max(8,Math.min(.75*a,20)),e=2*Math.PI*d/6,e=[0,e,e,e,e,e,e];return[new ol.style.Style({image:new ol.style.Circle({radius:d,stroke:new ol.style.Stroke({color:"rgba("+
b+",0.5)",width:15,lineDash:e,lineCap:"butt"}),fill:new ol.style.Fill({color:"rgba("+b+",1)"})}),text:new ol.style.Text({text:a.toString(),fill:new ol.style.Fill({color:"#fff"})})})]});b=new ol.source.Cluster({distance:b,source:new ol.source.Vector});h.cluster[a]=new ol.custom.layer.AnimatedCluster({name:a,source:b,animationDuration:c,style:function(a,b){var c=a.get("features").length;if(!(0>=c)){var n=null;return n=1<c?e.call(this,c,b):d.call(this,a.get("features")[0],b)}}});"number"==typeof u&&
(u+=G,h.cluster[a].setZIndex(u));"number"!=typeof viewMaxObjects&&(viewMaxObjects=60);"number"!=typeof circleMaxObjects&&(circleMaxObjects=10);m.addLayer(h.cluster[a]);P.push(h.cluster[a]);s[a]={};e&&(s[a].CLUSTER_STYLE=e);f&&(s[a].MAX_OBJECT_ERROR=f);d&&(s[a].FEATURE_STYLE=d);g&&(s[a].SELECT=g);l&&(s[a].UNSELECT=l);n&&(s[a].HOVER=n)}function ea(a,b,c,e,d,f,g,l,n,u){sa(a);b||(b=new ol.source.Vector);e||(e=function(a,b,c){return Ja});b={name:a,layerType:"VECTOR",style:e,source:b};"undefined"!=typeof u&&
(b.visible=u);I&&(b.extent=I);h.vector[a]=new ol.layer.Vector(b);"number"==typeof n&&(n+=G,h.vector[a].setZIndex(n));m.addLayer(h.vector[a]);c&&ta(a,c);if(d||f||g||l)L.push(h.vector[a]),v[a]={},v[a].select=d,v[a].unselect=f,v[a].hover=g,v[a].unhover=l}function ua(a,b,c,e){var d=null;if("string"==typeof a)d=D.readFeature(a);else if("object"==typeof a)d=a;else return null;e&&d.getGeometry().transform(r,p);b&&d.setProperties(b);c&&d.setStyle(c);return d}function ta(a,b){if("undefined"==typeof b.length)b=
[b];else if(0==b.length)return;if(h.vector[a]){for(var c=0,e=b.length;c<e;c++)b[c].layerName=a;h.vector[a].getSource().addFeatures(b)}}function ma(a){var b=h.vector[a];if(b){for(var c=y.featureClick.getFeatures(),e=c.getArray(),d=[],f=0,g=e.length;f<g;f++){var l=e[f];l.layerName==a&&d.push(l)}f=0;for(g=d.length;f<g;f++)c.remove(d[f]);b.getSource().clear()}}function ba(){var a=q.getCenter();return a=ol.proj.transform(a,p,r)}function va(a,b){var c=q.calculateExtent(m.getSize());b&&(c=ol.proj.transformExtent(c,
p,r));if(a&&"extent"!=a.toLowerCase()){c=ol.geom.Polygon.fromExtent(c);if("polygon"==a.toLowerCase())return c;if("string"==a.toLowerCase())return D.writeGeometry(c)}else return c}function Ka(a){var b=null;switch(a.toUpperCase()){case "POINT":b="Point";break;case "LINE":b="LineString";break;case "POLYGON":b="Polygon";break;case "MULTI_POINT":b="MultiPoint";break;case "MULTI_LINE":b="MultiLineString";break;case "MULTI_POLYGON":b="MultiPolygon";break;case "CIRCLE":b="Circle";break;default:b=null}return b}
function La(a,b,c,e,d,f){E("DRAW_FEATURE");document.body.removeEventListener("keyup",wa);a=Ka(a);Q=null;if(a){e&&(Q=e);b&&h.vector.DRAW_FEATURE.setStyle(b);h.vector.DRAW_FEATURE.isMulti=c?!0:!1;b=a;"Circle"==a&&"number"==typeof f&&0<f?(b="Point",h.vector.DRAW_FEATURE.radius=f):h.vector.DRAW_FEATURE.radius=null;if(d&&"object"==typeof d&&d.length){f=h.vector.DRAW_FEATURE.getSource();c=0;for(var g=d.length;c<g;c++){var l=d[c],n=l.type,u=null,k={GEOM_TYPE:n,RADIUS:0};if("Circle"==n){var n=ol.proj.transform(l.center,
r,p),u=q.getResolution(),m=ol.proj.getPointResolution(p,u,n),n=new ol.geom.Circle(n,l.radius/ol.proj.METERS_PER_UNIT.m*(u/m)),u=new ol.Feature({geometry:n});k.RADIUS=l.radius}else u=ua(l.geom,null,null,!0);u.layerName="DRAW_FEATURE";u.setProperties(k);f.addFeature(u)}}d=new ol.interaction.Draw({features:h.vector.DRAW_FEATURE.getSource().getFeatures(),type:b});b=new ol.interaction.Modify({source:h.vector.DRAW_FEATURE.getSource()});E("DRAW_FEATURE",d);E("MODIFY_FEATURE",b);document.body.addEventListener("keyup",
wa);b.on("modifyend",function(a){a=a.features.getArray();var b=h.vector.DRAW_FEATURE;if(b){for(var b=b.getSource(),c=0,d=a.length;c<d;c++){var n=a[c],f=n.getGeometry().getType();if("Circle"==f){var g=n.getGeometry(),l=ol.proj.transform(g.getCenter(),p,r),g=ol.proj.transform(g.getLastCoordinate(),p,r),l=N.haversineDistance(l,g);n.setProperties({GEOM_TYPE:f,RADIUS:l})}}e&&fa(b,e)}});d.on("drawstart",function(a){a=h.vector.DRAW_FEATURE;a.isMulti||a.getSource().clear()});d.on("drawend",function(b){b=
b.feature;var c=h.vector.DRAW_FEATURE;b.layerName="DRAW_FEATURE";if(c){var c=c.getSource(),d=b.getGeometry().getType(),e=0;if("Circle"==d)var n=b.getGeometry(),e=ol.proj.transform(n.getCenter(),p,r),n=ol.proj.transform(n.getLastCoordinate(),p,r),e=N.haversineDistance(e,n);else if("Point"==d&&"Circle"==a){var e=h.vector.DRAW_FEATURE.radius,d=b.getGeometry().clone(),n=q.getResolution(),f=ol.proj.getPointResolution(p,n,d.getCoordinates()),n=e/ol.proj.METERS_PER_UNIT.m*(n/f),d=new ol.geom.Circle(d.getCoordinates(),
n);b.setGeometry(d);d="Circle"}b.setProperties({GEOM_TYPE:d,RADIUS:e});c.addFeature(b);Q&&fa(c)}},this)}else h.vector.DRAW_FEATURE.getSource().clear()}function wa(a){46==a.keyCode&&null!=R&&(y.featureHover.getFeatures().remove(R),y.featureClick.getFeatures().remove(R),a=h.vector.DRAW_FEATURE.getSource(),a.removeFeature(R),R=null,V(),fa(a))}function fa(a){a=a.getFeatures();for(var b=[],c=0,e=a.length;c<e;c++){var d=a[c],f=d.getGeometry(),d=d.getProperties(),g=d.GEOM_TYPE,l=0,n=[0,0],h="";"Circle"==
g?(l=d.RADIUS,n=ol.extent.getCenter(f.getExtent()),n=ol.proj.transform(n,p,r),h=ol.geom.Polygon.circular(N,n,l)):"Polygon"==g||"LineString"==g?(n=ol.extent.getCenter(f.getExtent()),n=ol.proj.transform(n,p,r),h=f.clone(),h.transform(p,r)):(h=f.clone(),h.transform(p,r),n=h.getCoordinates());h=D.writeGeometry(h);b[c]={type:g,radius:l,center:n,geom:h}}Q&&Q.call(this,b)}function xa(a,b){var c=a.getImage();if("function"==typeof window.btoa){var e=new XMLHttpRequest,d=b.split("?"),f=d[0],g=null;1<d.length&&
(g=d[1].replace(/&/g,'"\x26').replace(/=/g,'\x3d"')+'"');e.open("POST",f,!0);e.responseType="arraybuffer";e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.onload=function(a){if(200==this.status){a=new Uint8Array(this.response);for(var b=a.length,d=Array(b);b--;)d[b]=String.fromCharCode(a[b]);a=d.join("");-1==a.indexOf("xml")?(b=e.getResponseHeader("content-type"),0===b.indexOf("image")?c.src="data:"+b+";base64,"+window.btoa(a):c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw\x3d\x3d"):
c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw\x3d\x3d"}else c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw\x3d\x3d"};e.send(g)}else c.src=b}function ya(a,b,c){var e=h.vector[a];a=null;if(e)for(var e=e.getSource().getFeatures(),d=0,f=e.length;d<f;d++){var g=e[d],l=g.getProperties();if("undefined"!=typeof l[b]&&l[b]==c){a=g;break}}return a}"undefined"==typeof k&&(k={});var q=null,m=null,p=null,M=null,r=null,h={base:{},vector:{},cluster:{},
wms:{},image:{}},D=new ol.format.WKT,N=new ol.Sphere(6378137),ia="undefined"==typeof k.isGeoDesic?!0:k.isGeoDesic,H=null,B={},y={},v={},L=[],P=[],s={},x=null,O=null,S=[],t={},z={},I="undefined"==typeof k.layerViewExtent?null:k.layerViewExtent,R=null,Q=null,C,w,X=null,J={moveend:{},movestart:{},click:{},zoomend:{},move:{},mousemove:{},rotate:{},pinchstart:{},pinchend:{}},G=0,Ja=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",
width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),za=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(53, 187, 205, 0.3)"}),stroke:new ol.style.Stroke({color:"#35bbcd",width:3}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#35bbcd"})})}),ka=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(53, 187, 205, 0.2)"}),stroke:new ol.style.Stroke({color:"rgb(53, 187, 205)",lineDash:[10,10],width:3}),image:new ol.style.Circle({radius:5,
stroke:new ol.style.Stroke({color:"rgb(53, 187, 205)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})}),ga=function(a){for(var b="",c=document.getElementsByTagName("script"),e=0,d=c.length;e<d;e++){var f=c[e];if(-1!=f.src.indexOf(a)){b=f.src;b=b.substr(0,b.lastIndexOf(a));break}}return b}("JBMap.js"),Aa=ga+"images/world.png",Ba=ga+"images/compass.png",oa=ga+"images/popup_close.png";k.path&&(k.path.worldImg&&(Aa=k.path.worldImg),k.path.compassImg&&(Ba=k.path.compassImg),k.path.closeImg&&
(oa=k.path.closeImg));var na={},$={MAIN:0,MAX:0};(function(){x=document.createElement("div");x.style.position="absolute";x.style.display="none";x.className="JBMap_TooltipBox";O=document.createElement("div");O.className="JBMap_viewZoom";t.minZoom="undefined"==typeof k.minZoom?1:k.minZoom;t.maxZoom="undefined"==typeof k.maxZoom?14:k.maxZoom;r="undefined"==typeof k.displayProjection?"EPSG:4326":k.displayProjection;p="undefined"==typeof k.projection?"EPSG:3857":k.projection;t.projection=p;t.zoom="undefined"==
typeof k.zoom?7:k.zoom;I&&(I=ol.proj.transformExtent(I,r,p));if(k.center){var a=k.center;try{a=ol.proj.transform(a,r,p),t.center=a}catch(b){t.center=null}}else t.center=ol.proj.transform([127.7528832672847,36.23307548960749],"EPSG:4326",p);k.resolutions&&(t.resolutions=k.resolutions);k.extent&&(H=ol.proj.transformExtent(k.extent,r,p),t.extent=H);q=new ol.View(t);a=null;B.ZOOM=new ol.custom.control.Zoom;k.isHideZoomControl&&(B.ZOOM.element.className+=" ol-hidden");k.isRotate?(a=new ol.interaction.DragRotate({condition:ol.custom.events.condition.ctrlKeyOnly}),
a=ol.interaction.defaults({altShiftDragRotate:!1,dragPan:!1,mouseWheelZoom:!1,doubleClickZoom:!1}).extend([a,new ol.interaction.DragPan({kinetic:!1}),new ol.custom.interaction.PinchZoom({constrainResolution:!0,pinchStart:function(a){A(JBMap.CODE.EVENT.PINCH_START,a)},pinchEnd:function(a){A(JBMap.CODE.EVENT.PINCH_END,a)}}),new ol.interaction.MouseWheelZoom({duration:0})])):a=ol.interaction.defaults({altShiftDragRotate:!1,dragPan:!1,pinchRotate:!1,pinchZoom:!1,mouseWheelZoom:!1,doubleClickZoom:!1}).extend([new ol.interaction.DragPan({kinetic:!1}),
new ol.custom.interaction.PinchZoom({constrainResolution:!0,pinchStart:function(a){A(JBMap.CODE.EVENT.PINCH_START,a)},pinchEnd:function(a){A(JBMap.CODE.EVENT.PINCH_END,a)}}),new ol.interaction.MouseWheelZoom({duration:0})]);var c={};null!=a&&(c.interactions=a);c.target="undefined"==typeof k.mapDiv?"map":k.mapDiv;c.view=q;a=[];a.push(B.ZOOM);c.controls=ol.control.defaults({zoom:!1,attribution:!1}).extend(a);var e=[];if("undefined"!=typeof k.baseLayers){h.base=k.baseLayers;for(var d in k.baseLayers)for(var f=
k.baseLayers[d].layer,a=0,g=f.length;a<g;a++)e.push(f[a])}c.layers=e;G=e.length;m=new ol.Map(c);d=m.getTargetElement();M=d.getElementsByTagName("CANVAS");M.length&&(M=M[0]);d.appendChild(x);k.isLongZoomControl&&(B.ZOOM_SLIDER=new ol.control.ZoomSlider,m.addControl(B.ZOOM_SLIDER));k.isScaleLine&&(B.SCALE_LINE=new ol.control.ScaleLine,m.addControl(B.SCALE_LINE));k.isWorldView&&(d=document.createElement("span"),a=(a=k.zoomToExtent)?ol.proj.transformExtent(a,r,p):k.extent?ol.proj.transformExtent(k.extent,
r,p):ol.proj.transformExtent([123.44238281249997,32.74570253945518,132.71484375,39.00637903337457],"EPSG:4326",p),d.innerHTML="\x3cimg alt\x3d'전체화면' src\x3d'"+Aa+"' class\x3d'JBZoomToExtentImg' /\x3e",B.ZOOM_TO_EXTENT=new ol.control.ZoomToExtent({extent:a,label:d}),m.addControl(B.ZOOM_TO_EXTENT));X=new ol.Graticule({strokeStyle:new ol.style.Stroke({color:"rgba(255, 120, 0, 0.9)",width:2,lineDash:[.5,4]}),showLabels:!0,lonLabelFormatter:function(a){return Math.round(1E3*a)/1E3},latLabelFormatter:function(a){return Math.round(1E3*
a)/1E3}});k.isGraticule&&X.setMap(m);d=m.getControls().getArray();a=0;for(g=d.length;a<g;a++)c=d[a],-1!=c.element.className.indexOf("ol-zoom ol-unselectable")&&(c.element.insertBefore(O,c.element.children[1]),O.innerHTML=q.getZoom());"undefined"!=typeof k.showBaseLayer?aa(k.showBaseLayer):(d=Object.keys(h.base),0<d.length&&aa(d[0]));q.on("change:center",ca);q.on("change:resolution",da);q.on("change:rotation",pa);m.on("moveend",qa);m.on("movestart",Ha);m.on("click",Fa);m.on("pointermove",function(a){var b=
a.pixel[1],c=a.pixel[0],d=x.offsetWidth,e=x.offsetHeight,f=m.getTargetElement().offsetWidth,g=m.getTargetElement().offsetHeight;x.style.top=(b+15+e>g?b-e-15:b+15)+"px";x.style.left=(c+15+d>f?c-d-15:c+15)+"px";Ga(a)});d="\x3cimg alt\x3d'방위각' src\x3d'"+Ba+"' style\x3d'width:100%;'/\x3e";c=document.getElementsByClassName("ol-compass");a=0;for(g=c.length;a<g;a++)c[a].innerHTML=d;ea("MEASURE",null,null,function(a,b,c){return za},null,null,null,null,99999999);G++;ea("DRAW_FEATURE",null,null,function(a,
b,c){return c?ka:za},null,null,null,null,99999999);G++;d=new ol.interaction.Select({condition:ol.events.condition.click,style:function(a,b){return h.vector[a.layerName].getStyle().call(this,a,b,"click")},layers:L});a={pointRadius:20,animate:!1,maxObjects:20,circleMaxObjects:20,isFeatureOpen:function(a){return(a=h.cluster[a.layerName])?a.getFeatureOpen():!0},maxObjectsError:function(a){var b=!1,c=a.length;if(0<c){var d=a[0].layerName;s[d]&&s[d].MAX_OBJECT_ERROR&&(b=s[d].MAX_OBJECT_ERROR.call(this,
c,a[0]))}return b},layers:P,featureStyle:function(a,b){var c=a.get("features"),d=null;if(c&&0<c.length){var e=c[0].layerName;s[e]&&s[e].FEATURE_STYLE&&(d=s[e].FEATURE_STYLE.call(this,c[0],b))}else d=[],d.push(new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0,0,0,0.4)",width:1})}));null==d&&(c=new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0,255,0,1)",width:1}),fill:new ol.style.Fill({color:"rgba(0,255,0,0.3)"})}),d=[],d.push(new ol.style.Style({image:c,stroke:new ol.style.Stroke({color:"rgba(0,0,0,0.4)",
width:1})})));return d},style:function(a,b){var c=a.get("features"),d=c.length,e=[];if(1<c.length){var f=c[0].layerName;s[f]&&s[f].CLUSTER_STYLE&&(e=s[f].CLUSTER_STYLE.call(this,d,b))}else f=c[0].layerName,s[f]&&s[f].FEATURE_STYLE&&(e=s[f].FEATURE_STYLE.call(this,d,b,"SELECT",c[0]));return e}};if(g=k.cluster)g.pointRadius&&(a.pointRadius=Math.max(20,g.pointRadius)),g.animate&&(a.animate=g.animate),g.maxObjects&&(a.maxObjects=g.maxObjects),g.circleMaxObjects&&(a.circleMaxObjects=g.circleMaxObjects);
a=new ol.custom.interaction.SelectCluster(a);a.getFeatures().on(["add"],function(a){a=a.element.get("features");if(1==a.length){a=a[0];var b=a.layerName;s[b]&&s[b].SELECT&&s[b].SELECT.call(this,a)}});a.getFeatures().on(["remove"],function(a){a=a.element.get("features");if(1==a.length){a=a[0];var b=a.layerName;s[b]&&s[b].UNSELECT&&s[b].UNSELECT.call(this,a)}});g=new ol.interaction.Select({condition:ol.events.condition.pointerMove,style:function(a,b){var c=h.vector[a.layerName];if(c)return c.getStyle().call(this,
a,b,"hover")},layers:L});E("ClusterClick",a);E("featureClick",d);E("featureHover",g);d.on("select",function(a){var b=a.selected;a=a.deselected;for(var c=0,d=a.length;c<d;c++){var e=a[c],f=e.layerName;v[f]&&v[f].unselect&&v[f].unselect.call(this,e)}c=0;for(d=b.length;c<d;c++)e=b[c],f=e.layerName,v[f]&&v[f].select&&v[f].select.call(this,e)});g.on("select",function(a){var b=a.selected;a=a.deselected;for(var c=0,d=a.length;c<d;c++){var e=a[c],f=e.layerName;v[f]&&v[f].unhover&&v[f].unhover.call(this,e)}c=
0;for(d=b.length;c<d;c++)if(e=b[c],f=e.layerName,v[f]&&v[f].hover)try{var g=v[f].hover.call(this,e);"undefined"!=typeof g&&null!=g&&(x.innerText=g,x.style.display="")}catch(h){console.log(h)}0==b.length&&V()});if("undefined"!=typeof k.overview){d={};d.maxZoom="undefined"==typeof k.overview.maxZoom?t.maxZoom:k.overview.maxZoom;d.minZoom="undefined"==typeof k.overview.minZoom?t.minZoom:k.overview.minZoom;d.projection="undefined"==typeof k.overview.projection?t.projection:k.overview.projection;"undefined"!=
typeof k.overview.resolutions?d.resolutions=k.overview.resolutions:k.resolutions&&(d.resolutions=k.resolutions);k.extent&&(d.extent=ol.proj.transformExtent(k.extent,r,d.projection));a={isExtentView:void 0!==k.overview.isExtentView?k.overview.isExtentView:!1,collapsed:void 0!==k.overview.isHide?k.overview.isHide:!1,label:void 0!==k.overview.showLabel?k.overview.showLabel:"»",collapseLabel:void 0!==k.overview.hideLabel?k.overview.hideLabel:"«",view:new ol.View(d)};d.extent&&(a.extent=d.extent);k.overview.layers&&
(a.layers=k.overview.layers);var l=new ol.custom.control.OverviewMap(a);setTimeout(function(){m.addControl(l);k.overview.initCallback&&k.overview.initCallback.call(this)},100)}})();return{getMap:function(){return m},resize:function(){m.updateSize()},changeBaseLayer:function(a){aa(a)},setEvent:function(a,b,c){T(a,b,c)},removeEvent:function(a,b){U(a,b)},destroy:function(){for(var a in h)for(var b in h[a])m.removeLayer(h[a][b]);q.un("change:center",ca);q.un("change:resolution",da);m.un("moveend",qa);
q=m=null},setCenter:function(a,b){ra(a,b)},getCenter:function(){return ba()},setZoom:function(a){q.setZoom(a)},getZoom:function(){return q.getZoom()},zoomIn:function(){var a=q.getZoom();q.setZoom(a+1)},zoomOut:function(){var a=q.getZoom();q.setZoom(a-1)},setRotate:function(a){try{q.rotate(a)}catch(b){console.log(b)}},getRotate:function(){return q.getRotation()},movePosition:function(a,b,c,e){a=F("POINT("+a+" "+b+")",r,p);try{q.setCenter(a.getCoordinates())}catch(d){console.log(d)}try{q.setZoom(c)}catch(f){console.log(f)}try{q.rotate(e)}catch(g){console.log(g)}},
getMapPosition:function(){return{lonlat:ba(),zoom:q.getZoom(),rotate:q.getRotation()}},getPixelByGeom:function(a,b){var c;c=a;"undefiend"==typeof c.getType()||"Point"!=c.getType()?(console.log("getPixelByGeom Parameter Not Point"),c=void 0):(b&&(c=F(c,r,p)),c=m.getPixelFromCoordinate(c.getCoordinates()));return c},getGeomByPixel:function(a,b){var c=null;"object"==typeof a&&a.length&&2==a.length?(c=m.getCoordinateFromPixel(a),c=new ol.geom.Point(c),b&&(c=F(c,p,r))):console.log("Not Pixel Data");return c},
transformByGeom:function(a,b,c){return F(a,b,c)},getBounds:function(){return va("string",!0)},getLengthByLine:function(a,b){var c;a:{c=null;if("string"==typeof a)c=D.readFeature(a).getGeometry();else if("object"==typeof a)c=a;else{c=null;break a}b&&(c=F(c,r,p));c=ha(c)}return c},getAreaByPolygon:function(a,b){var c;a:{c=null;if("string"==typeof a)c=D.readFeature(a).getGeometry();else if("object"==typeof a)c=a;else{c=null;break a}b&&(c=F(c,r,p));c=ja(c)}return c},getExtent:function(a,b){return va(a,
b)},setExtent:function(a,b,c,e){a=[a,b,c,e];a=ol.proj.transformExtent(a,r,p);q.fit(a,m.getSize())},setZoomToExtent:function(a){if("string"==typeof a){var b=D.readGeometry(a);-1!=a.toUpperCase().indexOf("POINT(")?(ra(b.getCoordinates()[0],b.getCoordinates()[1]),a=q.getMaxZoom(),q.setZoom(a)):(b.transform(r,p),q.fit(b,m.getSize()))}else a=ol.proj.transformExtent(a,r,p),b=ol.geom.Polygon.fromExtent(a),q.fit(b,m.getSize())},getWKTGeom:function(a){var b;try{b=D.writeGeometry(a.transform(p,r))}catch(c){console.log(c),
b=null}return b},getGeomFromWKT:function(a,b,c){var e;try{var d=D.readGeometry(a);"undefined"!==typeof b&&"undefined"!==typeof c&&d.transform(b,c);e=d}catch(f){console.error(f),e=null}return e},setVisibleLayer:function(a,b){for(var c in h)for(var e in h[c])a==e&&h[c][e].setVisible(b)},setMeasureControl:function(a){Ca(a)},setTooltip:function(a,b,c,e,d,f,g){Da(a,b,c,e,d,f,g)},removeTooltip:function(a){Y(a)},moveTooltip:function(a,b){var c=b;if(z[a]){var e=z[a],d=null;"string"==typeof c&&(c=F(c,r,p));
d=c.length?c:"Point"==c.getType()?c.getCoordinates():ol.extent.getCenter(c.getExtent());e.setPosition(d)}},changeOpacity:function(a,b,c){a=a.toLowerCase();"base"!=a&&h[a]&&h[a][b]&&"number"==typeof c&&h[a][b].setOpacity(c)},changeLayerZIndex:function(a,b,c){a=a.toLowerCase();"base"!=a&&h[a]&&h[a][b]&&"number"==typeof c&&(c+=G,h[a][b].setZIndex(c))},setVectorLayer:function(a,b,c,e,d,f,g,h,n,k){ea(a,b,c,e,d,f,g,h,n,k)},removeVectorLayer:function(a){sa(a)},createFeature:function(a,b,c,e){return ua(a,
b,c,e)},addFeatures:function(a,b){ta(a,b)},removeAllFeatures:function(a){ma(a)},removeFeature:function(a,b,c){var e=h.vector[a];if(e){var d=y.featureClick.getFeatures();a=ya(a,b,c);d.remove(a);e.getSource().removeFeature(a)}},getFeature:function(a,b,c){return ya(a,b,c)},triggerFeatureClickEvent:function(a,b){a:{var c=y.featureClick,e=c.getFeatures(),d=e.getArray(),f=[],g=[];if(b)g.push(a),0<d.length?(d=d[0],d!=a&&(f.push(d),e.clear(),e.push(a))):e.push(a);else if(0==d.length)break a;else f.push(a),
e.clear();c.dispatchEvent({type:"select",selected:g,deselected:f})}},triggerFeatureHoverEvent:function(a,b){a:{var c=y.featureHover,e=c.getFeatures(),d=e.getArray(),f=[],g=[];if(b)g.push(a),0<d.length?(d=d[0],d!=a&&(f.push(d),e.clear(),e.push(a))):e.push(a);else if(0==d.length)break a;else f.push(a),e.clear();c.dispatchEvent({type:"select",selected:g,deselected:f})}},setDrawFeatureControl:function(a,b,c,e,d,f){La(a,b,c,e,d,f)},setWmsLayer:function(a,b,c,e,d,f,g,l,k,p){h.wms[a]&&(m.removeLayer(h.wms[a]),
delete h.wms[a]);if(b){c||(c={});c._t=(new Date).getTime();c.VERSION=l?l:"1.1.1";l={name:a,layerType:"WMS"};I&&(l.extent=I);f&&(l.opacity=f);"undefined"!=typeof g&&(l.visible=g);if(d){l.source=new ol.source.ImageWMS({url:b,crossOrigin:"Anonymous",params:c});p&&l.source.setImageLoadFunction(xa);if(k)l.source.on(["imageloadend","imageloaderror"],k);h.wms[a]=new ol.layer.Image(l)}else{c.TILED=!0;l.source=new ol.source.TileWMS({url:b,crossOrigin:"Anonymous",params:c});p&&l.source.setTileLoadFunction(xa);
if(k)l.source.on(["tileloadend","tileloaderror"],k);h.wms[a]=new ol.layer.Tile(l)}"number"==typeof e&&(e+=G,h.wms[a].setZIndex(e));m.addLayer(h.wms[a])}},removeWmsLayer:function(a){m.removeLayer(h.wms[a]);delete h.wms[a]},mergeNewParam:function(a,b){var c=h.wms[a];c&&c.getSource().updateParams(b)},setImageLayer:function(a,b,c,e,d,f,g,k){h.image[a]&&(m.removeLayer(h.image[a]),delete h.image[a]);if(b){b=-1!=b.indexOf("?")?b+("\x26time\x3d"+(new Date).getTime()):b+("?time\x3d"+(new Date).getTime());
var n={};n.url=b;n.crossOrigin="Anonymous";c&&(d&&(c=ol.proj.transformExtent(c,d,p)),n.imageExtent=c);e&&(n.imageSize=e);f||(f=1);e=new ol.source.ImageStatic(n);if(k)e.on(["imageloadend","imageloaderror"],k);h.image[a]=new ol.layer.Image({name:a,layerType:"IMAGE",opacity:f,source:e});"number"==typeof g&&(g+=G,h.image[a].setZIndex(g));m.addLayer(h.image[a])}},removeImageLayer:function(a){m.removeLayer(h.image[a]);delete h.image[a]},setLayerZoomToExtent:function(a){a=h.vector[a].getSource().getExtent();
m.getView().fit(a,m.getSize())},getWMSLayerInfoUrl:function(a,b,c,e,d,f){var g=e;e=q.getResolution();a=h.wms[a].getSource();g||(g=1);c={INFO_FORMAT:c,FEATURE_COUNT:g};c.VERSION=f?f:"1.1.1";d&&(c.callback=d);b=a.getGetFeatureInfoUrl(b,e,p,c);return b?b:null},setClusterLayer:function(a,b,c,e,d,f,g,h,k,m){Ia(a,b,c,e,d,f,g,h,k,m)},addClusterFeatures:function(a,b){var c=b;c.length||(c=[c]);if(h.cluster[a]){for(var e=0,d=c.length;e<d;e++)c[e].layerName=a;h.cluster[a].getSource().getSource().addFeatures(c)}},
removeAllClusterFeatures:function(a){if(h.cluster[a]){for(var b=y.ClusterClick,c=b.getFeatures(),e=c.getArray(),d=[],f=0,g=e.length;f<g;f++){var k=e[f],n=k.get("features"),m=null,m=0<n.length?n[0].layerName:a;m==a&&d.push(k)}f=0;for(g=d.length;f<g;f++)c.remove(d[f]);b.dispatchEvent({type:"select",selected:[],deselected:d});h.cluster[a].getSource().getSource().clear()}},removeClusterLayer:function(a){if(h.cluster[a]){m.removeLayer(h.cluster[a]);delete h.cluster[a];for(var b=0;b<P.length;b++){var c=
P[b];null!=c&&c.get("name")==a&&(P.splice(b,1),b--)}}},setClusterOpen:function(a,b){var c=h.cluster[a];c&&c.setFeatureOpen(b)},getLayers:function(){return h},setWindy:function(a,b,c){Ea(a,b,c)},removeWindy:function(){K();C=null;U(JBMap.CODE.EVENT.MOVE_START,"WINDY_MOVE");U(JBMap.CODE.EVENT.MOVE_END,"WINDY_MOVE");U(JBMap.CODE.EVENT.ZOOM_END,"WINDY_MOVE");w.remove();w=null},clearWindy:function(){K()},refreshWindy:function(){W()},showGraticule:function(a){a?X.setMap(m):X.setMap(null)},isHitCheck:function(a){var b=
m.getEventPixel(a.originalEvent),c=m.hasFeatureAtPixel(b);c&&(c=!1,m.forEachFeatureAtPixel(a.pixel,function(a,b){if(!c&&b){var f=b.get("name");v[f]&&(c=!0)}}));return c},getHitFeature:function(a,b,c){var e=m.getEventPixel(b.originalEvent),d=m.hasFeatureAtPixel(e),f=[];d&&m.forEachFeatureAtPixel(b.pixel,function(b,c){if(d&&c){var e=c.get("name");a==e&&f.push(b)}});c.call(this,f)},saveCaptureMap:function(a,b){var c=document.createElement("A");c.download=a;var e=null;switch(b){case "jpeg":e=M.toDataURL("image/jpeg");
break;default:e=M.toDataURL("image/png")}for(var d=e.split(","),e=d[0].match(/:(.*?);/)[1],d=atob(d[1]),f=d.length,g=new Uint8Array(f);f--;)g[f]=d.charCodeAt(f);e=new Blob([g],{type:e});0<navigator.appVersion.toString().indexOf(".NET")?window.navigator.msSaveBlob(e,a):(e=URL.createObjectURL(e),c.href=e,c.click())},saveText:function(a,b){var c=new Blob([b],{type:"text/plain"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(c,a);else{var c=URL.createObjectURL(c),
e=document.createElement("A");e.download=a;e.href=c;e.click()}},setCRS:function(a,b){proj4.defs(a,b)}}};
JBMap.CODE={EVENT:{MOVE_END:"moveend",MOVE_START:"movestart",CLICK:"click",ZOOM_END:"zoomend",MOVE:"move",MOUSE_MOVE:"mousemove",ROTATE:"rotate",PINCH_START:"pinchstart",PINCH_END:"pinchend"},FEATURE_INFO_FORMAT:{JSON:"application/json",HTML:"text/html",JSONP:"text/javascript",GML2:"application/vnd.ogc.gml",GML3:"application/vnd.ogc.gml/3.1.1",TEXT:"text/plain"},DRAW_TYPE:{POINT:"point",LINE:"line",POLYGON:"polygon",CIRCLE:"circle",NONE:"none"},TOOLTIP_POSITION:{LEFT_TOP:"top-left",LEFT_MIDDLE:"center-left",
LEFT_BOTTOM:"bottom-left",CENTER_TOP:"top-center",CENTER_MIDDLE:"center-center",CENTER_BOTTOM:"bottom-center",RIGHT_TOP:"top-right",RIGHT_MIDDLE:"center-right",RIGHT_BOTTOM:"bottom-right"},MEASURE_CONTROL:{NONE:"NONE",LENGTH:"LENGTH",AREA:"AREA"}};