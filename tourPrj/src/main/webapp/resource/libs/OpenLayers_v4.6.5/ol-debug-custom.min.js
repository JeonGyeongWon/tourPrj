ol.custom={};ol.custom.events={};ol.custom.control={};ol.custom.source={};ol.custom.layer={};ol.custom.interaction={};ol.custom.events.condition={};ol.custom.events.condition.ctrlKeyOnly=function(a){a=a.originalEvent;return a.ctrlKey&&!(a.metaKey||a.altKey)&&!a.shiftKey};
ol.custom.control.Zoom=function(a){a=a?a:{};var b=void 0!==a.className?a.className:"ol-zoom",d=void 0!==a.delta?a.delta:1,c=void 0!==a.zoomInLabel?a.zoomInLabel:"+",e=void 0!==a.zoomOutLabel?a.zoomOutLabel:"−",f=void 0!==a.zoomInTipLabel?a.zoomInTipLabel:"Zoom in",h=void 0!==a.zoomOutTipLabel?a.zoomOutTipLabel:"Zoom out",g=document.createElement("button");g.className=b+"-in";g.setAttribute("type","button");g.title=f;g.appendChild("string"===typeof c?document.createTextNode(c):c);g.addEventListener("click",
ol.custom.control.Zoom.prototype.handleClick_.bind(this,d));c=document.createElement("button");c.className=b+"-out";c.setAttribute("type","button");c.title=h;c.appendChild("string"===typeof e?document.createTextNode(e):e);c.addEventListener("click",ol.custom.control.Zoom.prototype.handleClick_.bind(this,-d));b+=" ol-unselectable ol-control";d=document.createElement("div");d.className=b;d.appendChild(g);d.appendChild(c);ol.control.Control.call(this,{element:d,target:a.target});this.duration_=void 0!==
a.duration?a.duration:250};ol.inherits(ol.custom.control.Zoom,ol.control.Control);ol.custom.control.Zoom.prototype.handleClick_=function(a,b){b.preventDefault();this.zoomByDelta_(a)};ol.custom.control.Zoom.prototype.zoomByDelta_=function(a){var b=this.getMap().getView();if(b){var d=b.getMaxZoom(),c=b.getMinZoom();a=b.getZoom()+a;a>d&&(a=d);a<c&&(a=c);b.setZoom(a)}};
ol.custom.control.OverviewMap=function(a){a=a?a:{};this.collapsed_=void 0!==a.collapsed?a.collapsed:!0;this.extent=void 0!==a.extent?a.extent:null;this.isExtentView=void 0!==a.isExtentView?a.isExtentView:!1;this.projection=void 0!==a.projection?a.projection:"EPSG:3857";var b=this.extent;this.collapsible_=void 0!==a.collapsible?a.collapsible:!0;this.collapsible_||(this.collapsed_=!1);var d=void 0!==a.className?a.className:"ol-overviewmap",c=void 0!==a.tipLabel?a.tipLabel:"Overview map",e=void 0!==
a.collapseLabel?a.collapseLabel:"«";"string"===typeof e?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=e):this.collapseLabel_=e;e=void 0!==a.label?a.label:"»";"string"===typeof e?(this.label_=document.createElement("span"),this.label_.textContent=e):this.label_=e;var f=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,e=document.createElement("button");e.setAttribute("type","button");e.title=c;e.appendChild(f);ol.events.listen(e,"click",this.handleClick_,
this);this.ovmapDiv_=document.createElement("DIV");this.ovmapDiv_.className="ol-overviewmap-map";var h=this.ovmap_=new ol.PluggableMap({controls:new ol.Collection,interactions:new ol.Collection,view:a.view});a.layers&&a.layers.forEach(function(a){h.addLayer(a)},this);c=document.createElement("DIV");c.className="ol-overviewmap-box";c.style.boxSizing="border-box";this.boxOverlay_=new ol.Overlay({position:[0,0],positioning:ol.OverlayPositioning.BOTTOM_LEFT,element:c});this.ovmap_.addOverlay(this.boxOverlay_);
d=d+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible");c=document.createElement("div");c.className=d;c.appendChild(this.ovmapDiv_);c.appendChild(e);ol.control.Control.call(this,{element:c,render:a.render?a.render:ol.custom.control.OverviewMap.render,target:a.target});var g=this,m=this.boxOverlay_,n=this.boxOverlay_.getElement(),k=function(a){return{clientX:a.clientX-n.offsetWidth/2,clientY:a.clientY+
n.offsetHeight/2}},p=function(a){var d=a.clientX;a=a.clientY;if(b){var c=[b[2],b[3]],e=h.getPixelFromCoordinate([b[0],b[1]]),g=h.getPixelFromCoordinate(c),f=h.viewport_.getBoundingClientRect(),c=e[0]+f.left,e=e[1]+f.top,m=g[0]+f.left,g=g[1]+f.top;d<c&&(d=c);d>m&&(d=m);a<g&&(a=g);a>e&&(a=e)}return{clientX:d,clientY:a}},q=function(a){a=h.getEventCoordinate(k(p(a)));m.setPosition(a)},l=function(a){a=h.getEventCoordinate(p(a));a=ol.proj.transform(a,h.getView().getProjection(),g.getMap().getView().getProjection());
g.getMap().getView().setCenter(a);window.removeEventListener("mousemove",q);window.removeEventListener("mouseup",l)};n.addEventListener("mousedown",function(){window.addEventListener("mousemove",q);window.addEventListener("mouseup",l)})};ol.inherits(ol.custom.control.OverviewMap,ol.control.Control);
ol.custom.control.OverviewMap.prototype.setMap=function(a){var b=this.getMap();if(a!==b&&(b&&((b=b.getView())&&this.unbindView_(b),this.ovmap_.setTarget(null)),ol.control.Control.prototype.setMap.call(this,a),a)){this.ovmap_.setTarget(this.ovmapDiv_);this.listenerKeys.push(ol.events.listen(a,ol.ObjectEventType.PROPERTYCHANGE,this.handleMapPropertyChange_,this));if(0===this.ovmap_.getLayers().getLength()){new ol.layer.Group;for(var d=a.getLayerGroup().getLayersArray().clone(),c=0,e=d.length;c<e;c++)b=
d[c],this.ovmap_.addLayer(b)}this.isExtentView&&null!=this.extent&&(c=ol.geom.Polygon.fromExtent(this.extent),d=new ol.source.Vector,b=new ol.layer.Vector({name:"Extent View",source:d}),this.ovmap_.addLayer(b),b=new ol.Feature({geometry:c,name:"Extent"}),d.addFeature(b));if(a=a.getView())this.bindView_(a),a.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())}};
ol.custom.control.OverviewMap.prototype.handleMapPropertyChange_=function(a){a.key===ol.MapProperty.VIEW&&((a=a.oldValue)&&this.unbindView_(a),a=this.getMap().getView(),this.bindView_(a))};ol.custom.control.OverviewMap.prototype.bindView_=function(a){ol.events.listen(a,ol.Object.getChangeEventType(ol.ViewProperty.ROTATION),this.handleRotationChanged_,this)};
ol.custom.control.OverviewMap.prototype.unbindView_=function(a){ol.events.unlisten(a,ol.Object.getChangeEventType(ol.ViewProperty.ROTATION),this.handleRotationChanged_,this)};ol.custom.control.OverviewMap.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())};ol.custom.control.OverviewMap.render=function(a){this.validateExtent_();this.updateBox_()};
ol.custom.control.OverviewMap.prototype.validateExtent_=function(){var a=this.getMap(),b=this.ovmap_;if(a.isRendered()&&b.isRendered()){var d=a.getSize(),a=a.getView().calculateExtent(d),c=b.getSize(),d=b.getView().calculateExtent(c),e=b.getPixelFromCoordinate(ol.extent.getTopLeft(a)),f=b.getPixelFromCoordinate(ol.extent.getBottomRight(a)),b=Math.abs(e[0]-f[0]),e=Math.abs(e[1]-f[1]),f=c[0],c=c[1];b<f*ol.OVERVIEWMAP_MIN_RATIO||e<c*ol.OVERVIEWMAP_MIN_RATIO||b>f*ol.OVERVIEWMAP_MAX_RATIO||e>c*ol.OVERVIEWMAP_MAX_RATIO?
this.resetExtent_():ol.extent.containsExtent(d,a)||this.recenter_()}};
ol.custom.control.OverviewMap.prototype.resetExtent_=function(){if(0!==ol.OVERVIEWMAP_MAX_RATIO&&0!==ol.OVERVIEWMAP_MIN_RATIO){var a=this.getMap(),b=this.ovmap_,d=a.getSize(),d=a.getView().calculateExtent(d),d=ol.proj.transformExtent(d,a.getView().getProjection(),this.projection),a=b.getView(),b=Math.log(ol.OVERVIEWMAP_MAX_RATIO/ol.OVERVIEWMAP_MIN_RATIO)/Math.LN2,b=1/(Math.pow(2,b/2)*ol.OVERVIEWMAP_MIN_RATIO);ol.extent.scaleFromCenter(d,b);a.fit(d)}};
ol.custom.control.OverviewMap.prototype.recenter_=function(){var a=this.getMap(),b=this.ovmap_,d=a.getView(),b=b.getView(),d=d.getCenter(),d=ol.proj.transform(d,a.getView().getProjection(),this.projection);b.setCenter(d)};
ol.custom.control.OverviewMap.prototype.updateBox_=function(){var a=this.getMap(),b=this.ovmap_;if(a.isRendered()&&b.isRendered()){var d=a.getSize(),c=a.getView(),e=b.getView(),f=c.getRotation(),b=this.boxOverlay_,h=this.boxOverlay_.getElement(),d=c.calculateExtent(d),d=ol.proj.transformExtent(d,a.getView().getProjection(),this.projection),a=e.getResolution(),c=ol.extent.getBottomLeft(d),d=ol.extent.getTopRight(d),f=this.calculateCoordinateRotate_(f,c);b.setPosition(f);h&&(h.style.width=Math.abs((c[0]-
d[0])/a)+"px",h.style.height=Math.abs((d[1]-c[1])/a)+"px")}};ol.custom.control.OverviewMap.prototype.calculateCoordinateRotate_=function(a,b){var d,c=this.getMap(),e=c.getView().getCenter();if(e=ol.proj.transform(e,c.getView().getProjection(),this.projection))d=[b[0]-e[0],b[1]-e[1]],ol.coordinate.rotate(d,a),ol.coordinate.add(d,e);return d};ol.custom.control.OverviewMap.prototype.handleClick_=function(a){a.preventDefault();this.handleToggle_()};
ol.custom.control.OverviewMap.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed");this.collapsed_?ol.dom.replaceNode(this.collapseLabel_,this.label_):ol.dom.replaceNode(this.label_,this.collapseLabel_);this.collapsed_=!this.collapsed_;var a=this.ovmap_;this.collapsed_||a.isRendered()||(a.updateSize(),this.resetExtent_(),ol.events.listenOnce(a,ol.MapEventType.POSTRENDER,function(a){this.updateBox_()},this))};ol.custom.control.OverviewMap.prototype.getCollapsible=function(){return this.collapsible_};
ol.custom.control.OverviewMap.prototype.setCollapsible=function(a){this.collapsible_!==a&&(this.collapsible_=a,this.element.classList.toggle("ol-uncollapsible"),!a&&this.collapsed_&&this.handleToggle_())};ol.custom.control.OverviewMap.prototype.setCollapsed=function(a){this.collapsible_&&this.collapsed_!==a&&this.handleToggle_()};ol.custom.control.OverviewMap.prototype.getCollapsed=function(){return this.collapsed_};ol.custom.control.OverviewMap.prototype.getOverviewMap=function(){return this.ovmap_};
ol.custom.source.Vworld=function(a){function b(a){a.baseUrl||(a.baseUrl="http://api.vworld.kr/req/wmts/1.0.0/");if(a.key)if(a.type){var c=ol.custom.source.Vworld.CODE[a.type];c?("undefined"==typeof a.minZoom&&(a.minZoom=c.min),"undefined"==typeof a.maxZoom&&(a.maxZoom=c.max),"undefined"==typeof a.url&&(a.url=a.baseUrl+a.key+"/"+c.name+"/{z}/{y}/{x}."+c.type),ol.source.XYZ.call(this,a)):console.error("[type] 옵션은 (BASE, GRAY, MIDNIGHT, HYBRID, SATELLITE) 중에 선택하여야 합니다. ")}else console.error("[type] 옵션은 필수값입니다. (BASE, GRAY, MIDNIGHT, HYBRID, SATELLITE)");
else console.error("브이월드 API Key는 필수값입니다.")}ol.source.XYZ&&(b.__proto__=ol.source.XYZ);b.prototype=Object.create(ol.source.XYZ&&ol.source.XYZ.prototype);return b.prototype.constructor=b}(ol.source.XYZ);
ol.custom.source.Vworld.CODE={BASE:{name:"Base",korean:"일반지도",min:6,max:19,type:"png"},GRAY:{name:"gray",korean:"회색지도",min:6,max:18,type:"png"},MIDNIGHT:{name:"midnight",korean:"Midnight지도",min:6,max:18,type:"png"},HYBRID:{name:"Hybrid",korean:"하이브리드지도",min:6,max:19,type:"png"},SATELLITE:{name:"Satellite",korean:"영상지도",min:6,max:19,type:"jpeg"}};ol.custom.source.NGII={};ol.custom.source.NGII.INFO={};
ol.custom.source.NGII.INFO.resolution=[2088.96,1044.48,522.24,261.12,130.56,65.28,32.64,16.32,8.16,4.08,2.04,1.02,.51,.255];ol.custom.source.NGII.INFO.maxExtent=[-2E5,-2.802412362E7,3.182412362E7,4E6];
ol.custom.source.NGII.BASE=function(a){function b(a){for(var c=ol.custom.source.NGII.INFO.resolution,b=[],f=ol.extent.getTopLeft(ol.custom.source.NGII.INFO.maxExtent),h=0;h<c.length;++h){var g=h+5;b[h]="L"+(10>g?"0"+g:g)}c={matrixSet:"korean",style:"korean",crossOrigin:"Anonymous",format:"image/png",tileGrid:new ol.tilegrid.WMTS({origin:f,resolutions:c,matrixIds:b})};a.url?a.key?(c.url=a.url+"/openapi/Gettile.do?apikey\x3d"+a.key,c.layer=a.type,ol.source.WMTS.call(this,c)):console.error("국토정보플랫폼 API Key는 필수값입니다."):
console.error("국토정보플랫폼 접속 URL 정보는 필수값입니다. EX) http://mapapi.ngii.go.kr:8013")}ol.source.WMTS&&(b.__proto__=ol.source.WMTS);b.prototype=Object.create(ol.source.WMTS&&ol.source.WMTS.prototype);return b.prototype.constructor=b}(ol.source.WMTS);
ol.custom.source.NGII.BASE.code={layers_id:{ENGLISH:"english_map",KOREAN:"korean_map",CHINESE:"chinese_map",JAPANESE:"japanese_map",COLOR:"color_map",BIG_LABEL:"lowV_map",WHITE:"white_map",EDU_WHITE:"white_edu_map"},layers_label:{ENGLISH:"영문지도",KOREAN:"국문지도",CHINESE:"중문지도",JAPANESE:"일문지도",COLOR:"색각지도",BIG_LABEL:"큰글씨 지도",WHITE:"백지도",EDU_WHITE:"교육용 백지도"}};
ol.custom.layer.AnimatedCluster=function(a){a=a||{};ol.layer.Vector.call(this,a);this.oldcluster=new ol.source.Vector;this.clusters=[];this.isFeatureOpen=!0;this.animation={start:!1};this.set("animationDuration","number"==typeof a.animationDuration?a.animationDuration:700);this.set("animationMethod",a.animationMethod||ol.easing.easeOut);this.getSource().on("change",this.saveCluster,this);this.on("precompose",this.animate,this);this.on("postcompose",this.postanimate,this)};
ol.inherits(ol.custom.layer.AnimatedCluster,ol.layer.Vector);ol.custom.layer.AnimatedCluster.prototype.setFeatureOpen=function(a){this.isFeatureOpen=a};ol.custom.layer.AnimatedCluster.prototype.getFeatureOpen=function(){return this.isFeatureOpen};
ol.custom.layer.AnimatedCluster.prototype.saveCluster=function(){this.oldcluster.clear();if(this.get("animationDuration")){var a=this.getSource().getFeatures();a.length&&a[0].get("features")&&(this.oldcluster.addFeatures(this.clusters),this.clusters=a.slice(0),this.sourceChanged=!0)}};ol.custom.layer.AnimatedCluster.prototype.getClusterForFeature=function(a,b){for(var d=0;b[d];d++){var c=b[d].get("features");if(c&&c.length)for(var e=0,f;f=c[e];e++)if(a===f)return b[d]}return!1};
ol.custom.layer.AnimatedCluster.prototype.stopAnimation=function(){this.animation.start=!1;this.animation.cA=[];this.animation.cB=[]};
ol.custom.layer.AnimatedCluster.prototype.animate=function(a){var b=this.get("animationDuration");if(b){var d=a.frameState.viewState.resolution,c=this.animation,e=a.frameState.time;if(c.resolution!=d&&this.sourceChanged){e=a.frameState.extent;c.resolution<d?(e=ol.extent.buffer(e,100*d),c.cA=this.oldcluster.getFeaturesInExtent(e),c.cB=this.getSource().getFeaturesInExtent(e),c.revers=!1):(e=ol.extent.buffer(e,100*d),c.cA=this.getSource().getFeaturesInExtent(e),c.cB=this.oldcluster.getFeaturesInExtent(e),
c.revers=!0);c.clusters=[];for(var e=0,f;f=c.cA[e];e++){var h=f.get("features");if(h&&h.length){var g=this.getClusterForFeature(h[0],c.cB);g&&c.clusters.push({f:f,pt:g.getGeometry().getCoordinates()})}}c.resolution=d;this.sourceChanged=!1;if(!c.clusters.length||1E3<c.clusters.length){this.stopAnimation();return}e=c.start=(new Date).getTime()}if(c.start){f=a.vectorContext;b=(e-c.start)/b;1<b&&(this.stopAnimation(),b=1);var b=this.get("animationMethod")(b),m=this.getStyle(),h="function"==typeof m?m:
m.length?function(){return m}:function(){return[m]};a.context.save();a.context.globalAlpha=this.getOpacity();for(var n=a.frameState.pixelRatio,e=0;g=c.clusters[e];e++){var k=g.f.getGeometry().getCoordinates();c.revers?(k[0]=g.pt[0]+b*(k[0]-g.pt[0]),k[1]=g.pt[1]+b*(k[1]-g.pt[1])):(k[0]+=b*(g.pt[0]-k[0]),k[1]+=b*(g.pt[1]-k[1]));for(var g=h(g.f,d),k=new ol.geom.Point(k),p=0;s=g[p];p++){var q,l=ol.Map.prototype.getFeaturesAtPixel?!1:s.getImage();l&&(q=l.getScale(),l.setScale(q*n));f.setStyle?(f.setStyle(s),
f.drawGeometry(k)):(f.setImageStyle(l),f.setTextStyle(s.getText()),f.drawPointGeometry(k));l&&l.setScale(q)}}a.context.restore();a.frameState.animate=!0;a.context.save();a.context.beginPath();a.context.rect(0,0,0,0);a.context.clip();this.clip_=!0}}};ol.custom.layer.AnimatedCluster.prototype.postanimate=function(a){this.clip_&&(a.context.restore(),this.clip_=!1)};
ol.custom.interaction.SelectCluster=function(a){a=a||{};this.pointRadius=a.pointRadius||12;this.circleMaxObjects=a.circleMaxObjects||10;this.maxObjects=a.maxObjects||60;this.spiral=!1!==a.spiral;this.animate=a.animate;this.isFeatureOpen=a.isFeatureOpen;this.maxObjectsError=a.maxObjectsError;this.animationDuration=a.animationDuration||500;this.selectCluster_=!1!==a.selectCluster;var b=this.overlayLayer_=new ol.layer.Vector({source:new ol.source.Vector({features:new ol.Collection,useSpatialIndex:!0}),
name:"Cluster overlay",updateWhileAnimating:!0,updateWhileInteracting:!0,displayInLayerSwitcher:!1,style:a.featureStyle});if(a.layers)if("function"==typeof a.layers){var d=a.layers;a.layers=function(a){return a===b||d(a)}}else a.layers.push&&a.layers.push(this.overlayLayer_);a.filter?(d=a.filter,a.filter=function(a,b){return!b&&a.get("selectclusterlink")?!1:d(a,b)}):a.filter=function(a,b){return!b&&a.get("selectclusterlink")?!1:!0};this.filter_=a.filter;ol.interaction.Select.call(this,a);this.on("select",
this.selectCluster,this)};ol.inherits(ol.custom.interaction.SelectCluster,ol.interaction.Select);ol.custom.interaction.SelectCluster.prototype.setMap=function(a){this.getMap()&&(this.getMap().getView()&&this.getMap().getView().un("change:resolution",this.clear,this),this.getMap().removeLayer(this.overlayLayer_));this.overlayLayer_.setMap(a);ol.interaction.Select.prototype.setMap.call(this,a);if(a&&a.getView())a.getView().on("change:resolution",this.clear,this)};
ol.custom.interaction.SelectCluster.prototype.clear=function(){this.getFeatures().clear();this.overlayLayer_.getSource().clear()};ol.custom.interaction.SelectCluster.prototype.getLayer=function(){return this.overlayLayer_};
ol.custom.interaction.SelectCluster.prototype.selectCluster=function(a){if(a.selected.length){var b=a.selected[0];if(!b.get("selectclusterfeature")){a=this.overlayLayer_.getSource();a.clear();var d=b.get("features");if(d&&1!=d.length){this.selectCluster_||this.getFeatures().clear();var b=b.getGeometry().getCoordinates(),c=this.getMap().getView().getResolution(),e=c*this.pointRadius*(.5+d.length/4);if(!this.spiral||d.length<=this.circleMaxObjects){if(!this.isFeatureOpen||this.isFeatureOpen(d[0])){var f=
Math.min(d.length,this.circleMaxObjects);for(i=0;i<f;i++){var h=2*Math.PI*i/f;if(2==f||4==f)h+=Math.PI/4;var g=[b[0]+e*Math.sin(h),b[1]+e*Math.cos(h)],m=new ol.Feature({selectclusterfeature:!0,features:[d[i]],geometry:new ol.geom.Point(g)});m.setStyle(d[i].getStyle());a.addFeature(m);g=new ol.Feature({selectclusterlink:!0,geometry:new ol.geom.LineString([b,g])});a.addFeature(g)}}}else{var h=0,n=2*this.pointRadius,f=Math.min(this.maxObjects,d.length);if(d.length>this.maxObjects&&this.maxObjectsError&&
(e=this.maxObjectsError.call(this,d),void 0!==e&&!e))return;for(i=0;i<f;i++)e=n/2+n*h/(2*Math.PI),h+=(n+.1)/e,g=c*e*Math.sin(h),e=c*e*Math.cos(h),g=[b[0]+g,b[1]+e],m=new ol.Feature({selectclusterfeature:!0,features:[d[i]],geometry:new ol.geom.Point(g)}),m.setStyle(d[i].getStyle()),a.addFeature(m),g=new ol.Feature({selectclusterlink:!0,geometry:new ol.geom.LineString([b,g])}),a.addFeature(g)}this.animate&&this.animateCluster_(b)}}}else this.clear()};
ol.custom.interaction.SelectCluster.prototype.animateCluster_=function(a){function b(b){for(var c=b.vectorContext,n=b.frameState.pixelRatio,k=b.target.getView().getResolution(),p=ol.easing.easeOut((b.frameState.time-h)/f),q=0,l;l=d[q];q++)if(l.get("features")){var r=l.getGeometry().getCoordinates();r[0]=a[0]+p*(r[0]-a[0]);r[1]=a[1]+p*(r[1]-a[1]);r=new ol.geom.Point(r);l=e(l,k);for(var u=0;u<l.length;u++){var v,t=ol.Map.prototype.getFeaturesAtPixel?!1:l[u].getImage();t&&(v=t.getScale(),t.setScale(n));
c.setStyle?(c.setStyle(l[u]),c.drawGeometry(r)):(c.setImageStyle(t),c.drawPointGeometry(r));t&&t.setScale(v)}}1<p?(ol.Observable.unByKey(this.listenerKey_),this.overlayLayer_.setVisible(!0),this.overlayLayer_.changed()):b.frameState.animate=!0}this.listenerKey_&&(this.overlayLayer_.setVisible(!0),ol.Observable.unByKey(this.listenerKey_));var d=this.overlayLayer_.getSource().getFeatures();if(d.length){this.overlayLayer_.setVisible(!1);var c=this.overlayLayer_.getStyle(),e="function"==typeof c?c:c.length?
function(){return c}:function(){return[c]},f=this.animationDuration||500,h=(new Date).getTime();this.listenerKey_=this.getMap().on("postcompose",b,this)}};
ol.custom.interaction.PinchZoom=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ol.custom.interaction.PinchZoom.handleDownEvent_,handleDragEvent:ol.custom.interaction.PinchZoom.handleDragEvent_,handleUpEvent:ol.custom.interaction.PinchZoom.handleUpEvent_});a=a?a:{};this.constrainResolution_=a.constrainResolution||!1;this.anchor_=null;this.duration_=void 0!==a.duration?a.duration:400;this.pinchStart_=void 0!==a.pinchStart?a.pinchStart:null;this.pinchEnd_=void 0!==a.pinchEnd?a.pinchEnd:
null;this.lastScaleUpDown_=this.lastDistance_=void 0;this.lastScaleDelta_=1};ol.inherits(ol.custom.interaction.PinchZoom,ol.interaction.Pointer);
ol.custom.interaction.PinchZoom.handleDragEvent_=function(a){var b=1,d=this.targetPointers[0],c=this.targetPointers[1],e=d.clientX-c.clientX,d=d.clientY-c.clientY,e=Math.sqrt(e*e+d*d);void 0!==this.lastDistance_&&(b=this.lastDistance_/e);this.lastDistance_=e;a=a.map;var e=a.getView(),c=e.getResolution(),f=e.getMaxResolution(),h=e.getMinResolution(),d=c*b;d>f?(b=f/c,d=f):d<h&&(b=h/c,d=h);1!=b&&(this.lastScaleDelta_=b);b=a.getViewport().getBoundingClientRect();c=ol.interaction.Pointer.centroid(this.targetPointers);
c[0]-=b.left;c[1]-=b.top;this.anchor_=a.getCoordinateFromPixel(c);a.render();ol.interaction.Interaction.zoomWithoutConstraints(e,d,this.anchor_)};ol.custom.interaction.PinchZoom.handleUpEvent_=function(a){if(2>this.targetPointers.length){var b=a.map.getView();b.setHint(ol.ViewHint.INTERACTING,-1);var d=b.getResolution();if(this.constrainResolution_||d<b.getMinResolution()||d>b.getMaxResolution())d=b.getZoom(),b.setZoom(Math.round(d));if(this.pinchEnd_)try{this.pinchEnd_.call(this,a)}catch(c){console.log(c)}return!1}return!0};
ol.custom.interaction.PinchZoom.handleDownEvent_=function(a){if(2<=this.targetPointers.length){if(this.pinchStart_)try{this.pinchStart_.call(this,a)}catch(b){console.log(b)}a=a.map;this.anchor_=null;this.lastDistance_=void 0;this.lastScaleDelta_=1;this.handlingDownUpSequence||a.getView().setHint(ol.ViewHint.INTERACTING,1);return!0}return!1};